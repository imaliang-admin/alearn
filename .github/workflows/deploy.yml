name: alearn-deploy 🚀

on:
  push:
    branches:
      - master

jobs:
  alearn-build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 🚚
        uses: actions/checkout@v2.3.1

      - name: Install and Build 🔨
        run: |
          npm install
          npm run build
          cp README.md docs/.vuepress/dist
          cp CNAME docs/.vuepress/dist

#      - name: Set Env 🔨
#        env:
#          ACTION_DEPLOY_KEY: ${{ secrets.SSH_KEY }}
#        run: |
#          mkdir -p ~/.ssh/
#          echo "$ACTION_DEPLOY_KEY" | tr -d '\r' > ~/.ssh/id_rsa
#          chmod 600 ~/.ssh/id_rsa
#          ssh-keyscan github.com >> ~/.ssh/known_hosts

#      - name: Deploy To GitHub Pages 🚀
#        run: |
#          cd docs/.vuepress/dist
#          git config --global user.name 'aliang'
#          git config --global user.email 'aliang.link@foxmail.com'
#          git init
#          git add -A
#          git commit -m 'GitHub + 服务器 双线部署 🚀'
#          git push -f git@github.com:imaliang/alearn.git master:gh-pages


      - name: Deploy To Tx 🚀
        run: |
          rm -rf docs/.vuepress/dist/.git
          tar cvf alearn.tar docs/.vuepress/dist
          ftp -v -n ${{ secrets.FTP_IP }} <<EOF
          user ${{ secrets.FTP_USERNAME }} ${{ secrets.FTP_PASSWORD }}
          put 'alearn.tar'
          binary
          cd /ftphome/uploadData
          lcd  /ftphome/getUploadData
          mput *
          bye
          EOF


#      - name: Deploy To Tx 🚀
#        uses: SamKirkland/FTP-Deploy-Action@4.0.0
#        with:
#          server: ${{ secrets.FTP_IP }}
#          username: ${{ secrets.FTP_USERNAME }}
#          password: ${{ secrets.FTP_PASSWORD }}
#          local-dir: docs/.vuepress/dist/
#          server-dir: /alearn/

#ftp -v -n 81.70.241.155 <<EOF \n user github WMsASz2aFFsXyaLh \n EOF
#ftp -v -n 81.70.241.155 <<EOF user github WMsASz2aFFsXyaLh \n EOF
#
#
#               ftp 81.70.241.155 github WMsASz2aFFsXyaLh
#               ftp 81.70.241.155 -u github -p WMsASz2aFFsXyaLh
#               github
#               WMsASz2aFFsXyaLh
#
#               lftp github:WMsASz2aFFsXyaLh@81.70.241.155:21
#
#               ftp -nftp>open 81.70.241.155:21ftp>user github WMsASz2aFFsXyaLh
#
#               bye
#               put  "D:\dev\abc"